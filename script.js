// JavaScript code extracted from the combined version
// (For brevity, using same final JS content from previous message)

